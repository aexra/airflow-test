## ТЗ

Исходный файл с ТЗ лежит [здесь](./test.md)

##### Основное задание
> В бакет на S3 в будние дни по расписанию кладется файл csv с содержимым: автомобиль, стоимость в иностранной валюте, дата актуальности всего файла. Характеристики автомобилей: марка, модель, объем двигателя, год выпуска. С каждым файлом информация может изменяться: добавляются строки для других автомобилей, удаляются строки для уже бывших или же изменяется стоимость на них.
>
> Написать DAG для Apache Airflow, который переводит стоимость в рублевый эквивалент по актуальному на дату создания файла курсу ЦБ и складывает эту информацию в таблицу в GreenPlum. DAG должен работать с понедельника по субботу, но не по воскресеньям. В субботу необходимо использовать курс валют, актуальный на минувшую пятницу.
>
> Курс валют можно скачать с сайта ЦБ на нужную дату https://cbr.ru/scripts/xml_daily.asp?date_req=05/12/2021

##### Задание 1
> Используя свою первую реализацию задачи, проработать отказоустойчисвость задействованных элементов КХД следующим образом: указать в docstrings к каждому методу/таске, где необходимо, что может пойти не так (и нарушить DataPipeline); предлжить способ устранения данной ошибки (так, чтобы DataPipeline был стабилен).

##### Задание 2
> Так же, в docstrings, пометить элементы, несоответствующие основным принципам КХД. Переработать для соответствия.

##### Задание 3
> Спроектировать вьюху для аналитического отчета "Динамика цены автомобиля за месяц", с возможностью составить аналитику в разрезе марки или модели или года выпуска. Описать структуру в любой удобной форме.

## Реализация

[Итоговый DAG по заданию](./dags/cars_exam/merge_gp.py)

## Локальная развертка

Предполагается развертка под [Docker Desktop](https://www.docker.com/)

Запустите приложение
```bash
docker compose --profile flower up --remove-orphans
```

Если что-то очень пошло не так:
```bash
docker compose --profile flower down --volumes --remove-orphans
```